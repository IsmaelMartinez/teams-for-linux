Refactor index.js partitions and idle state of #1960 - by @IsmaelMartinez (#1968)
