Continue refactoring epic work of #1960 - by @IsmaelMartinez (#1966)
