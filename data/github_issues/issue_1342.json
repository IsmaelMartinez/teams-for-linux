{
    "id": 2409085305,
    "number": 1342,
    "title": "Single window sharing is blurry / low res.",
    "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\nWhen I share a single windows (versus sharing the complete screen) the shared window image received at the other is very poor: low resolution and blurry. I need to share the complete screen for the image to be received properly.\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Start a call (video or only voice)\r\n2. Click on share button\r\n3. Select window\r\n4. Choose the window\r\n5. Wait until the other end receives the image\r\n6. Share image at the other end is low res/blurry\r\n\r\n**Expected behavior**\r\nThe window is shared and received properly at the other end.\r\n\r\n**Screenshots**\r\nAs the problem is exposed at the other end, I don't have a screen shot, sorry.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Debian bookworm (12)\r\n - Installation package: x86_64 tar.gz\r\n - Version: 1.8.0\r\n - Plasma desktop on X11\r\n\r\n**Debug**\r\n\r\nI have some debug from console, but the browser debug does not seem meaning and BTW I have not been able to capture it (yet). Here is the console, the latest part seems the interesting one, around the blank lines:\r\n\r\n```\r\n$ ./teams-for-linux --webDebug --appLogLevels=error,info,warn,debug\r\n[DEBUG] configPath:,/home/user/.config/teams-for-linux\r\n[DEBUG] configFile:,[object Object]\r\n[DEBUG] Adding electron CLI flag 'ignore-gpu-blocklist'\r\n[DEBUG] Adding electron CLI flag 'enable-zero-copy'\r\n[DEBUG] Adding electron CLI flag 'enable-features' with value 'WebRTCPipeWireCapturer,PlatformHEVCDecoderSupport,CanvasOopRasterization,VaapiIgnoreDriverChecks,VaapiVideoDecoder,VaapiVideoEncoder,VaapiVideoDecodeLinuxGL'\r\n[DEBUG] Adding electron CLI flag 'enable-accelerated-video-decode'\r\n[DEBUG] Adding electron CLI flag 'disable-features' with value 'UseChromeOSDirectVideoDecoder'\r\n[DEBUG] Custom background service url is 'http://localhost'\r\n[DEBUG] processArgs:,/home/user/bin/teams-for-linux-1.8.0/teams-for-linux,--webDebug,--appLogLevels=error,info,warn,debug\r\n[DEBUG] testing RegExp processArgs false\r\n[DEBUG] testing RegExp processArgs false\r\n[DEBUG] testing RegExp processArgs false\r\n[DEBUG] Testing network using net.resolveHost() for teams.microsoft.com\r\n[DEBUG] Language codes es set for spellchecker\r\n[DEBUG] Network test successful with method dns\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[318474:0715/132229.335350:ERROR:CONSOLE(1)] \"Request Autofill.enable failed. {\"code\":-32601,\"message\":\"'Autofill.enable' wasn't found\"}\", source: devtools://devtools/bundled/core/protocol_client/protocol_client.js (1)\r\n[DEBUG] did-frame-finish-load,[object Object],true\r\n[DEBUG] did-finish-load\r\n[DEBUG] Badge count set to '0'\r\n[DEBUG] Badge count set to '0'\r\n[DEBUG] Badge count set to '0'\r\n[DEBUG] Badge count set to '1'\r\n[318474:0715/132238.789931:ERROR:CONSOLE(1)] \"Request Autofill.enable failed. {\"code\":-32601,\"message\":\"'Autofill.enable' wasn't found\"}\", source: devtools://devtools/bundled/core/protocol_client/protocol_client.js (1)\r\n[DEBUG] did-frame-finish-load,[object Object],false\r\n[DEBUG] Badge count set to '11'\r\n[DEBUG] Badge count set to '10'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 1s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 3s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 1s, IdleState: 'active'\r\n[DEBUG] Notificaion => Type: new-message, Audio: default, Title: <**retracted**>, Body: le estÃ¡ llamando\r\n[DEBUG] Notification sounds are disabled\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 1s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 3s, IdleState: 'active'\r\n[318562:0715/132520.383905:ERROR:vaapi_video_decoder.cc(1235)] failed Initialize()ing the frame pool\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 5s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 10s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 1s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[318474:0715/132622.484178:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n[318474:0715/132623.208110:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n[318474:0715/132623.209283:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n[318474:0715/132624.276100:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n[318474:0715/132624.992955:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n[318562:0715/132625.529188:ERROR:vaapi_video_decoder.cc(1235)] failed Initialize()ing the frame pool\r\n[318474:0715/132626.025238:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n[318562:0715/132627.434759:ERROR:vaapi_video_decoder.cc(1235)] failed Initialize()ing the frame pool\r\n\r\n\r\n\r\n\r\n\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 2s, IdleState: 'active'\r\n[318474:0715/132631.109605:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n\r\n\r\n\r\n\r\n\r\n\r\n[318474:0715/132639.313458:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[318474:0715/132641.318953:ERROR:window_list_utils.cc(62)] Failed to query for child windows although windowdoes not have a valid WM_STATE.\r\n[318562:0715/132642.146544:ERROR:vaapi_video_decoder.cc(1235)] failed Initialize()ing the frame pool\r\n[318562:0715/132643.859162:ERROR:vaapi_video_decoder.cc(1235)] failed Initialize()ing the frame pool\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 1s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 3s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 13s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[318562:0715/132924.877014:ERROR:vaapi_video_decoder.cc(1235)] failed Initialize()ing the frame pool\r\n[318562:0715/132927.744356:ERROR:vaapi_video_decoder.cc(1235)] failed Initialize()ing the frame pool\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n``` \r\n\r\n**Additional context**\r\n\r\nThis problem is not 100% repeatable, some times the window (as opposed to screen) sharing works but most of the times it doesn't (I did not find a pattern). Also in this case note that I have tried to enable the video HW acceleration but it also happened the same way before I tried the HW accel optimization.",
    "state": "closed",
    "created_at": "2024-07-15T15:55:49+00:00",
    "updated_at": "2024-09-09T22:12:36+00:00",
    "closed_at": "2024-08-23T17:52:55+00:00",
    "user": "raul-klg",
    "assignee": null,
    "labels": [],
    "comments_count": 19,
    "html_url": "https://github.com/IsmaelMartinez/teams-for-linux/issues/1342",
    "is_pull_request": false
}