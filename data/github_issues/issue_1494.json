{
    "id": 2690564032,
    "number": 1494,
    "title": "White screen after login",
    "body": "**Describe the bug**\r\nI am getting the email and password prompts; and after that, even the question to \"stay signed in\" – it doesn't matter whether I click Yes or No here.\r\n\r\nAfter that, there are some loading icons but eventually, I'm stuck on the white screen afterwards. (Technically, there is a white box with rounded corners and drop-shadow).\r\n\r\nUpon opening the debug mode and refreshing, the console shows a multitude of errors.\r\n\r\n```\r\n[Auth]: auth_cache initialized\r\n[Auth]: authTelemetryProvider initialized\r\n[Auth]: [Telemetry][f9109af9-7bca-4755-aee5-b10a77f51336][auth_web_initialization] [start] - telemetry provider created for createAuthenticationServiceInstance, source: core-auth-tasks::init with shouldCreateScenario: [true]\r\n[Auth]: authTelemetryProvider initialized\r\nUncaught (in promise) Error: Discover::regionGtm::InvalidResponse - peopleProfileService is missing in discover response\r\n    at c (precompiled-web-worker-3661e62c1ac1c411.js:1:1779620)\r\n    at precompiled-web-worker-3661e62c1ac1c411.js:1:6016565\r\nUncaught (in promise) Error: Discover::regionGtm::InvalidResponse - presenceUPS is missing in discover response\r\n    at c (precompiled-web-worker-3661e62c1ac1c411.js:1:1779620)\r\n    at precompiled-web-worker-3661e62c1ac1c411.js:1:6016565\r\nUncaught (in promise) Error: Discover::regionGtm::InvalidResponse - teamsAndChannelsProvisioningService is missing in discover response\r\n    at c (precompiled-web-worker-3661e62c1ac1c411.js:1:1779620)\r\n    at precompiled-web-worker-3661e62c1ac1c411.js:1:6016565\r\nUncaught (in promise) Error: Discover::regionGtm::InvalidResponse - iC3LocationService is missing in discover response\r\n    at c (precompiled-web-worker-3661e62c1ac1c411.js:1:1779620)\r\n    at precompiled-web-worker-3661e62c1ac1c411.js:1:6016565\r\nUncaught (in promise) Error: Discover::regionGtm::InvalidResponse - appsSuggestionService is missing in discover response\r\n    at c (precompiled-web-worker-3661e62c1ac1c411.js:1:1779620)\r\n    at precompiled-web-worker-3661e62c1ac1c411.js:1:6016565\r\nUncaught (in promise) Error: Discover::regionGtm::InvalidResponse - iC3LocationService is missing in discover response\r\n    at c (precompiled-web-worker-3661e62c1ac1c411.js:1:1779620)\r\n    at precompiled-web-worker-3661e62c1ac1c411.js:1:6016565\r\nFailed to override MS Method\r\nFailed to start Activity Hub by assigning Event Handlers\r\nFailed to set Default Title\r\nFailed to set Machine State\r\nFailed to load resource: the server responded with a status of 404 () manifest.json:1 \r\n```\r\n\r\nI get the same result when visiting https://teams.live.com/v2/ directly – which seems to be what this app is doing too. (tested in Chrome, Firefox, even Edge, deactivated all browser extensions, tried in incognito mode, turned off the VPN I am behind)\r\n\r\nFurther interesting error messages I get over in the browser:\r\n\r\n```\r\nUnhandled error/rejection {\"isTrusted\":true}\r\nGET https://teams.live.com/v2/manifest.json 404 (Not Found)\r\n\r\nUncaught (in promise) {\r\n\tcode: \"Unknown\"\r\n\tcontext: \"DataLayerClient\"\r\n\terrorCode: undefined\r\n\tisExpected: false\r\n\tmessage: \"RequireStatusFailed\"\r\n\tname: \"PresenceCreateEndpointJob\"\r\n\toriginalErrorMessage: \"RequireStatusFailed\"\r\n\toriginalErrorReason: \"RequireStatusFailed\"\r\n\treason: undefined\r\n\tserverResponse: {\r\n\t\tstatus: 500\r\n\t\turl: \"https://presence.teams.live.com/v1/me/endpoints/\"\r\n\tstatusCode: 500\r\n\tsubContext: \"PresenceCreateEndpointJob\"\r\n}\r\n```\r\n\r\nWhy is the manifest not reachable? And why only for me?\r\n\r\nHonestly, I'm not sure whether there is anything you can do if it's a server-side issue. But is it truly? Maybe you can help me debug this. Just because you have the insight about how this login flow works, I mean. The last commit to this repository having been a few hours ago makes me believe you aren't getting this. It all points to a local issue with my personal machine. Otherwise, I'd find way more search results about login issues like this.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Open app.\r\n2. Enter credentials and log in.\r\n3. → White screen / error in console.\r\n\r\n**Expected behavior**\r\nThe user is either logged in and lands on a dashboard or landing page – or they get an error message displayed in the frontend, not dev console.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Ubuntu 24.04.1 LTS\r\n - Installation package: snap\r\n - Version: 1.11.5 stable\r\n\r\n\r\n**Debug**\r\n\r\n```bash\r\n$ teams-for-linux --webDebug --logConfig={}\r\nNo config file found, using default values\r\nall good with appLogLevels you aren't using them\r\nall good with onlineCheckMethod you aren't using them\r\nInitialising logger with config: \"{}\"\r\n13:02:25.486 › File logging at /home/$USER/snap/teams-for-linux/715/.config/teams-for-linux/logs/main.log with level silly\r\n13:02:25.487 › Console logging enabled with level silly\r\n13:02:25.487 › Logger initialised\r\n13:02:25.487 › configPath: /home/$USER/snap/teams-for-linux/715/.config/teams-for-linux\r\n13:02:25.487 › configFile: {}\r\n13:02:25.489 › Running under Wayland, switching to PipeWire...\r\ndbus-send: /snap/teams-for-linux/715/lib/x86_64-linux-gnu/libdbus-1.so.3: version `LIBDBUS_PRIVATE_1.12.20' not found (required by dbus-send)\r\n\r\n(teams-for-linux:25469): Gtk-WARNING **: 13:02:25.538: Theme parsing error: gtk.css:1422:23: 'font-feature-settings' is not a valid property name\r\n\r\n(teams-for-linux:25469): Gtk-WARNING **: 13:02:25.541: Theme parsing error: gtk.css:3308:25: 'font-feature-settings' is not a valid property name\r\n\r\n(teams-for-linux:25469): Gtk-WARNING **: 13:02:25.542: Theme parsing error: gtk.css:3770:23: 'font-feature-settings' is not a valid property name\r\n[25469:1125/130225.594846:ERROR:object_proxy.cc(576)] Failed to call method: org.freedesktop.Secret.Service.ReadAlias: object_path= /org/freedesktop/secrets: org.freedesktop.DBus.Error.AccessDenied: An AppArmor policy prevents this sender from sending this message to this recipient; type=\"method_call\", sender=\":1.334\" (uid=1231611329 pid=25469 comm=\"/snap/teams-for-linux/715/teams-for-linux --no-san\" label=\"snap.teams-for-linux.teams-for-linux (enforce)\") interface=\"org.freedesktop.Secret.Service\" member=\"ReadAlias\" error name=\"(unset)\" requested_reply=\"0\" destination=\"org.freedesktop.secrets\" (uid=1231611329 pid=3120 comm=\"/usr/bin/gnome-keyring-daemon --foreground --compo\" label=\"unconfined\")\r\n13:02:25.633 › processArgs: [\r\n  '/snap/teams-for-linux/715/teams-for-linux',\r\n  '--no-sandbox',\r\n  '--webDebug',\r\n  '--logConfig={}'\r\n]\r\n13:02:25.634 › testing RegExp processArgs false\r\n13:02:25.634 › testing RegExp processArgs false\r\n13:02:25.635 › testing RegExp processArgs false\r\n13:02:25.635 › testing RegExp processArgs false\r\n13:02:25.635 › Waiting for network...\r\n13:02:25.635 › Testing network using net.request() for https://teams.microsoft.com\r\n13:02:25.637 › Spellchecker is disabled!\r\n\r\n(teams-for-linux:25469): Gtk-WARNING **: 13:02:25.659: Theme parsing error: gtk.css:1422:23: 'font-feature-settings' is not a valid property name\r\n\r\n(teams-for-linux:25469): Gtk-WARNING **: 13:02:25.661: Theme parsing error: gtk.css:3308:25: 'font-feature-settings' is not a valid property name\r\n\r\n(teams-for-linux:25469): Gtk-WARNING **: 13:02:25.661: Theme parsing error: gtk.css:3770:23: 'font-feature-settings' is not a valid property name\r\nlibGL error: MESA-LOADER: failed to open iris (search paths /snap/teams-for-linux/715/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nlibGL error: failed to load driver: iris\r\nlibGL error: MESA-LOADER: failed to open swrast (search paths /snap/teams-for-linux/715/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nlibGL error: failed to load driver: swrast\r\n[25563:1125/130225.713544:ERROR:angle_platform_impl.cc(44)] Display.cpp:1083 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1083 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[25563:1125/130225.713765:ERROR:gl_display.cc(497)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[25563:1125/130225.713841:ERROR:gl_display.cc(767)] eglInitialize OpenGL failed with error EGL_NOT_INITIALIZED, trying next display type\r\n[25469:1125/130225.715428:ERROR:object_proxy.cc(576)] Failed to call method: org.freedesktop.login1.Manager.Inhibit: object_path= /org/freedesktop/login1: org.freedesktop.DBus.Error.AccessDenied: An AppArmor policy prevents this sender from sending this message to this recipient; type=\"method_call\", sender=\":1.354\" (uid=1231611329 pid=25469 comm=\"/snap/teams-for-linux/715/teams-for-linux --no-san\" label=\"snap.teams-for-linux.teams-for-linux (enforce)\") interface=\"org.freedesktop.login1.Manager\" member=\"Inhibit\" error name=\"(unset)\" requested_reply=\"0\" destination=\"org.freedesktop.login1\" (uid=0 pid=1385 comm=\"/usr/lib/systemd/systemd-logind\" label=\"unconfined\")\r\n[25563:1125/130225.717043:ERROR:angle_platform_impl.cc(44)] Display.cpp:1083 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1083 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[25563:1125/130225.717212:ERROR:gl_display.cc(497)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[25563:1125/130225.717314:ERROR:gl_display.cc(767)] eglInitialize OpenGLES failed with error EGL_NOT_INITIALIZED\r\n[25563:1125/130225.717384:ERROR:gl_display.cc(801)] Initialization of all EGL display types failed.\r\n[25563:1125/130225.717457:ERROR:gl_ozone_egl.cc(26)] GLDisplayEGL::Initialize failed.\r\n[25563:1125/130225.721877:ERROR:angle_platform_impl.cc(44)] Display.cpp:1083 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1083 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[25563:1125/130225.721977:ERROR:gl_display.cc(497)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[25563:1125/130225.722040:ERROR:gl_display.cc(767)] eglInitialize OpenGL failed with error EGL_NOT_INITIALIZED, trying next display type\r\n[25563:1125/130225.724253:ERROR:angle_platform_impl.cc(44)] Display.cpp:1083 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1083 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[25563:1125/130225.724407:ERROR:gl_display.cc(497)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[25563:1125/130225.724446:ERROR:gl_display.cc(767)] eglInitialize OpenGLES failed with error EGL_NOT_INITIALIZED\r\n[25563:1125/130225.724485:ERROR:gl_display.cc(801)] Initialization of all EGL display types failed.\r\n[25563:1125/130225.724519:ERROR:gl_ozone_egl.cc(26)] GLDisplayEGL::Initialize failed.\r\n[25563:1125/130225.726213:ERROR:viz_main_impl.cc(181)] Exiting GPU process due to errors during initialization\r\nMESA-LOADER: failed to open iris (search paths /snap/teams-for-linux/715/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nfailed to load driver: iris\r\nMESA-LOADER: failed to open kms_swrast (search paths /snap/teams-for-linux/715/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nfailed to load driver: kms_swrast\r\nMESA-LOADER: failed to open swrast (search paths /snap/teams-for-linux/715/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nfailed to load swrast driver\r\n13:02:25.928 › Network test successful with method https\r\n13:02:26.305 › GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[25469:1125/130226.308005:ERROR:object_proxy.cc(576)] Failed to call method: org.freedesktop.ScreenSaver.GetActive: object_path= /org/freedesktop/ScreenSaver: org.freedesktop.DBus.Error.NotSupported: This method is not part of the idle inhibition specification: https://specifications.freedesktop.org/idle-inhibit-spec/latest/\r\n13:02:26.661 › did-frame-finish-load {} true\r\n13:02:26.661 › did-finish-load\r\n13:02:28.503 › Badge count set to '0'\r\n13:02:28.748 › GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n13:02:28.920 › did-frame-finish-load {} true\r\n13:02:28.920 › did-finish-load\r\n13:02:29.763 › Badge count set to '0'\r\n13:02:29.896 › did-frame-finish-load {} false\r\n13:02:38.788 › GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n```\r\n\r\nI'm noticing this `org.freedesktop.DBus.Error.AccessDenied: An AppArmor policy prevents this sender from sending this message to this recipient;` which seems odd. I had run `echo 'kernel.apparmor_restrict_unprivileged_userns = 0' | sudo tee /etc/sysctl.d/20-apparmor-donotrestrict.conf` a few months ago in order to install Docker, which had deactivated the armor feature altogether, to my understanding.\r\n\r\n\r\n**Additional information**\r\nAccording to [this guide](https://idroot.us/install-microsoft-teams-ubuntu-24-04/), I could supposedly install a *.DEB file instead from [the official download page](https://www.microsoft.com/en-us/microsoft-teams/download-app). But I see no *.DEB link there – only a link that redirects me to https://teams.live.com/v2/",
    "state": "closed",
    "created_at": "2024-11-25T12:25:35+00:00",
    "updated_at": "2024-11-26T14:19:55+00:00",
    "closed_at": "2024-11-25T16:25:16+00:00",
    "user": "WoodrowShigeru",
    "assignee": null,
    "labels": [],
    "comments_count": 7,
    "html_url": "https://github.com/IsmaelMartinez/teams-for-linux/issues/1494",
    "is_pull_request": false
}