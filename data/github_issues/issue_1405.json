{
    "id": 2524576970,
    "number": 1405,
    "title": "Fails to detect active connection: `Testing network using net.request() for https://teams.microsoft.com`",
    "body": "**Describe the bug**\r\nFor the last few days, I've been unable to use the application. On startup, it pops up an empty window with the title \"No internet connection\", and logs this to the console:\r\n\r\n```\r\n13:06:18.231 › Testing network using net.request() for https://teams.microsoft.com\r\n13:06:19.233 › Network test failed with method https\r\n13:06:19.233 › No internet connection\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Start `teams-for-linux`\r\n\r\n**Expected behavior**\r\nNormal startup.\r\n\r\n**Screenshots**\r\nNot useful (the log messages say it all).\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Debian sid on amd64\r\n - Installation package: deb\r\n - Version: 1.8.1 and 1.10.2\r\n\r\n**Debug**\r\n\r\n```bash\r\n% teams-for-linux --webDebug\r\nNo config file found, using default values\r\nall good with appLogLevels you aren't using them\r\nInitialising logger with config: \"{}\"\r\nLogger initialised with transports: {}\r\n13:10:34.418 › File logging at /home/korn/.config/teams-for-linux/logs/main.log with level silly\r\n13:10:34.421 › Console logging enabled with level silly\r\n13:10:34.422 › Logger initialised\r\n13:10:34.422 › configPath: /home/korn/.config/teams-for-linux\r\n13:10:34.423 › configFile: {}\r\n[9563:0913/131101.100878:ERROR:object_proxy.cc(576)] Failed to call method: org.kde.KWallet.isEnabled: object_path= /modules/kwalletd5: org.freedesktop.DBus.Error.NoReply: Did not receive a reply. Possible causes include: the remote application did not send a reply, the message bus security policy blocked the reply, the reply timeout expired, or the network connection was broken.\r\n[9563:0913/131101.100910:ERROR:kwallet_dbus.cc(112)] Error contacting kwalletd5 (isEnabled)\r\n[9563:0913/131101.101097:ERROR:object_proxy.cc(576)] Failed to call method: org.kde.KLauncher.start_service_by_desktop_name: object_path= /KLauncher: org.freedesktop.DBus.Error.ServiceUnknown: The name is not activatable\r\n[9563:0913/131101.101131:ERROR:kwallet_dbus.cc(81)] Error contacting klauncher to start kwalletd5\r\n[9563:0913/131126.126264:ERROR:object_proxy.cc(576)] Failed to call method: org.kde.KWallet.close: object_path= /modules/kwalletd5: org.freedesktop.DBus.Error.NoReply: Did not receive a reply. Possible causes include: the remote application did not send a reply, the message bus security policy blocked the reply, the reply timeout expired, or the network connection was broken.\r\n[9563:0913/131126.126285:ERROR:kwallet_dbus.cc(502)] Error contacting kwalletd5 (close)\r\n13:11:26.302 › processArgs: [ '/opt/teams-for-linux/teams-for-linux', '--webDebug' ]\r\n13:11:26.303 › testing RegExp processArgs false\r\n13:11:26.304 › testing RegExp processArgs false\r\n13:11:26.304 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:26.307 › Spellchecker is disabled!\r\n[9563:0913/131126.643723:ERROR:network_service_instance_impl.cc(599)] Network service crashed, restarting service.\r\n13:11:27.651 › Network test failed with method https\r\n13:11:27.651 › Waiting for network...\r\n13:11:27.651 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:28.653 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:29.655 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:30.657 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:31.659 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:32.662 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:33.664 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:34.667 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:35.669 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:36.671 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:37.673 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:38.675 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:39.677 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:40.679 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:41.684 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:42.686 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:43.687 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:44.689 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:45.691 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:46.694 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:47.696 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:48.698 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:49.700 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:50.702 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:51.704 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:52.706 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:53.707 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:54.709 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:55.712 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:56.713 › Testing network using net.request() for https://teams.microsoft.com\r\n13:11:57.715 › Network test failed with method https\r\n13:11:57.716 › No internet connection\r\n```\r\n\r\nFrom `main.log`:\r\n\r\n```\r\n[2024-09-13 13:11:26.302] [debug] processArgs: [ '/opt/teams-for-linux/teams-for-linux', '--webDebug' ]\r\n[2024-09-13 13:11:26.303] [debug] testing RegExp processArgs false\r\n[2024-09-13 13:11:26.304] [debug] testing RegExp processArgs false\r\n[2024-09-13 13:11:26.304] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:26.307] [debug] Spellchecker is disabled!\r\n[2024-09-13 13:11:27.651] [debug] Network test failed with method https\r\n[2024-09-13 13:11:27.651] [debug] Waiting for network...\r\n[2024-09-13 13:11:27.651] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:28.653] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:29.655] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:30.657] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:31.659] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:32.662] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:33.664] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:34.667] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:35.669] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:36.671] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:37.673] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:38.675] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:39.677] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:40.679] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:41.684] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:42.686] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:43.687] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:44.689] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:45.691] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:46.694] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:47.696] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:48.698] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:49.700] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:50.702] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:51.704] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:52.706] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:53.707] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:54.709] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:55.712] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:56.713] [debug] Testing network using net.request() for https://teams.microsoft.com\r\n[2024-09-13 13:11:57.715] [debug] Network test failed with method https\r\n[2024-09-13 13:11:57.716] [error] No internet connection\r\n```\r\n\r\nHowever, https://teams.microsoft.com/ is accessible:\r\n\r\n```\r\n% wget -S -O /dev/null https://teams.microsoft.com/\r\n--2024-09-13 13:13:28--  https://teams.microsoft.com/\r\nResolving teams.microsoft.com (teams.microsoft.com)... 52.123.129.14, 52.123.128.14, 2603:1063:27:2::14, ...\r\nConnecting to teams.microsoft.com (teams.microsoft.com)|52.123.129.14|:443... connected.\r\nHTTP request sent, awaiting response... \r\n  HTTP/1.1 302 Found\r\n  Location: https://teams.microsoft.com/v2?clientexperience=t2\r\n  strict-transport-security: max-age=2592000\r\n  x-ring-info: web: general [assigned], mt: general [assigned]\r\n  requestid: 5921fd3a87b24f8e5df006236449e784\r\n  x-content-type-options: nosniff\r\n  timing-allow-origin: *\r\n  x-xss-protection: 1; mode=block\r\n  x-frame-options: SAMEORIGIN\r\n  x-envoy-upstream-service-time: 11\r\n  x-request-id: 7346a823-27d8-44d1-b71b-0e8e66888667\r\n  X-Cache: CONFIG_NOCACHE\r\n  X-MSEdge-Ref: Ref A: E3FDC45C92C84DED8EB48D4721F89D52 Ref B: BUD01EDGE0322 Ref C: 2024-09-13T11:13:25Z\r\n  Set-Cookie: MUIDB=1B810E3C170C6F5E3ABD1AC5161C6E0C; path=/; httponly; secure; expires=Wed, 08-Oct-2025 11:13:25 GMT\r\n  Date: Fri, 13 Sep 2024 11:13:25 GMT\r\n  Content-Length: 0\r\nLocation: https://teams.microsoft.com/v2?clientexperience=t2 [following]\r\n--2024-09-13 13:13:28--  https://teams.microsoft.com/v2?clientexperience=t2\r\nReusing existing connection to teams.microsoft.com:443.\r\nHTTP request sent, awaiting response... \r\n  HTTP/1.1 301 Moved Permanently\r\n  Location: /v2/?clientexperience=t2\r\n  X-MSEdge-Ref: Ref A: D1693075A8A844599BE6FB7C1BE36F40 Ref B: BUD01EDGE0322 Ref C: 2024-09-13T11:13:25Z\r\n  Date: Fri, 13 Sep 2024 11:13:25 GMT\r\n  Content-Length: 0\r\nLocation: /v2/?clientexperience=t2 [following]\r\n--2024-09-13 13:13:28--  https://teams.microsoft.com/v2/?clientexperience=t2\r\nReusing existing connection to teams.microsoft.com:443.\r\nHTTP request sent, awaiting response... \r\n  HTTP/1.1 302 Found\r\n  Location: /v2/unsupported-browser#env=work\r\n  strict-transport-security: max-age=2592000\r\n  x-ring-info: web: general [assigned];\r\n  requestid: 75fc3382583135a6fc49ba4fdecd0bca\r\n  x-content-type-options: nosniff\r\n  timing-allow-origin: *\r\n  x-xss-protection: 1; mode=block\r\n  x-frame-options: SAMEORIGIN\r\n  x-envoy-upstream-service-time: 1\r\n  x-request-id: 03e37a48-735c-4caf-a5ba-6903038cd338\r\n  X-Cache: CONFIG_NOCACHE\r\n  X-MSEdge-Ref: Ref A: A7BBF6B8AD4744CAB646732DA93E052F Ref B: BUD01EDGE0322 Ref C: 2024-09-13T11:13:25Z\r\n  Date: Fri, 13 Sep 2024 11:13:25 GMT\r\n  Content-Length: 0\r\nLocation: /v2/unsupported-browser#env=work [following]\r\n--2024-09-13 13:13:28--  https://teams.microsoft.com/v2/unsupported-browser\r\nReusing existing connection to teams.microsoft.com:443.\r\nHTTP request sent, awaiting response... \r\n  HTTP/1.1 200 OK\r\n  Cache-Control: no-store, no-transform, must-revalidate, no-cache\r\n  Content-Length: 182166\r\n  Content-Type: text/html; charset=utf-8\r\n  Expires: Thu, 12 Sep 2024 11:13:25 GMT\r\n  Vary: Accept-Encoding\r\n  Set-Cookie: clocale=en-us; expires=Sat, 13 Sep 2025 11:13:25 GMT; path=/;Partitioned; secure; httponly\r\n  strict-transport-security: max-age=2592000\r\n  x-ring-info: web: general [assigned];\r\n  content-security-policy: base-uri 'none';default-src 'none';script-src 'nonce-rAm5sV1wTfE9KbRBnYjHnA==' 'unsafe-inline' 'report-sample';style-src 'nonce-rAm5sV1wTfE9KbRBnYjHnA==' 'unsafe-inline' 'report-sample';style-src-attr 'unsafe-inline' 'report-sample';img-src https://statics.teams.cdn.office.net;form-action 'none';frame-ancestors 'none';object-src 'none';upgrade-insecure-requests;require-trusted-types-for 'script';trusted-types 'none';report-uri https://csp.microsoft.com/report/teams-web-r4?v=24080212011&env=prod&exp=react-web-client&endpoint=unsupported-browser;\r\n  requestid: f0191791bbdf86df3df971d82ff72520\r\n  x-content-type-options: nosniff\r\n  timing-allow-origin: *\r\n  x-xss-protection: 1; mode=block\r\n  x-envoy-upstream-service-time: 2\r\n  x-request-id: ed3b2e2e-2333-4b4b-9099-adba054dacc4\r\n  X-Cache: CONFIG_NOCACHE\r\n  X-MSEdge-Ref: Ref A: 796C28337C0247A2B82EEBC19FF9AF56 Ref B: BUD01EDGE0322 Ref C: 2024-09-13T11:13:25Z\r\n  Date: Fri, 13 Sep 2024 11:13:25 GMT\r\nLength: 182166 (178K) [text/html]\r\nSaving to: ‘/dev/null’\r\n\r\n/dev/null                                                                                  100%[=======================================================================================================================================================================================================================================>] 177.90K  --.-KB/s    in 0.04s   \r\n\r\n2024-09-13 13:13:28 (3.92 MB/s) - ‘/dev/null’ saved [182166/182166]\r\n```\r\n\r\n**Additional context**\r\n\r\nUp to about a week ago I had no problem.\r\n\r\nTeams still works from Ferdium on the same computer, in the same network.",
    "state": "closed",
    "created_at": "2024-09-13T11:15:07+00:00",
    "updated_at": "2024-10-16T07:48:14+00:00",
    "closed_at": "2024-10-16T07:48:14+00:00",
    "user": "akorn",
    "assignee": null,
    "labels": [],
    "comments_count": 10,
    "html_url": "https://github.com/IsmaelMartinez/teams-for-linux/issues/1405",
    "is_pull_request": false
}