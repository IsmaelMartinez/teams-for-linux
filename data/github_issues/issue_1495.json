{
    "id": 2695262823,
    "number": 1495,
    "title": "Crash when clicking sys tray icon to re-\"open\" app on RHEL8",
    "body": "**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\nUsing the flatpak, if one closes the app to the systray and then tries to re-open, it crashes.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. RHEL8 in wayland mode with nouveau driver in classic gnome shell with redhat's using gnome-shell-extension-top-icons-3.32.1-39.el8_10.noarch\r\n2. version 1.11.5 of the flatpak\r\n3. Start teams for linux\r\n4. click the 'x' to close the app to the systray\r\n5. click the systray icon and choose to reopen the app\r\n6. crash\r\n\r\n**Expected behavior**\r\nApp reopens\r\n\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: RHEL8.10\r\n - Installation package flatpak\r\n - Version 1.11.5\r\n\r\n**Debug**\r\n\r\nFrom /var/log/messages:\r\n\r\nNov 26 10:51:10 wave journal[5302]: [AppIndicatorSupport-WARN] Impossible to send about-to-show to menu: Gio.DBusError: GDBus.Error:org.freedesktop.DBus.Error.Failed: error occurred in AboutToShow\r\nNov 26 10:51:11 wave journal[5302]: WL: error in client communication (pid 326929)\r\nNov 26 10:51:11 wave com.github.IsmaelMartinez.teams_for_linux.desktop[326929]: [2:1126/105111.937479:ERROR:wayland_event_watcher.cc(47)] libwayland: wl_surface#26: error 0: gtk_shell::get_gtk_surface already requested\r\nNov 26 10:51:11 wave kernel: traps: teams-for-linux[326929] trap invalid opcode ip:55cd345379b1 sp:7ffe4ec79250 error:0 in teams-for-linux[55cd334a2000+\r\n\r\n\r\nFrom commandprompt with the debug options on...\r\n\r\nflatpak run com.github.IsmaelMartinez.teams_for_linux --webDebug --logConfig='{}'                                                                                    \r\n[2:1126/105946.215980:ERROR:bus.cc(407)] Failed to connect to the bus: Failed to connect to socket /run/dbus/system_bus_socket: No such file or directory                          \r\nNo config file found, using default values                                                                                                                                         \r\nall good with appLogLevels you aren't using them                                                                                                                                   \r\nall good with onlineCheckMethod you aren't using them                                                                                                                              \r\nInitialising logger with config: \"{}\"                                                                                                                                              \r\n10:59:46.451 › File logging at /home/dwb/.var/app/com.github.IsmaelMartinez.teams_for_linux/config/teams-for-linux/logs/main.log with level silly                                  \r\n10:59:46.482 › Console logging enabled with level silly                                                                                                                            \r\n10:59:46.483 › Logger initialised                                                                                                                                                  \r\n10:59:46.483 › configPath: /home/dwb/.var/app/com.github.IsmaelMartinez.teams_for_linux/config/teams-for-linux                                                                     \r\n10:59:46.483 › configFile: {}                                                                                                                                                      \r\n10:59:46.486 › Running under Wayland, switching to PipeWire...                                                                                                                     \r\nLaunchProcess: failed to execvp:                                                                                                                                                   \r\nxdg-settings                                                                                                                                                                       \r\n[2:1126/105946.586646:ERROR:bus.cc(407)] Failed to connect to the bus: Failed to connect to socket /run/dbus/system_bus_socket: No such file or directory                          \r\n[2:1126/105946.586686:ERROR:bus.cc(407)] Failed to connect to the bus: Failed to connect to socket /run/dbus/system_bus_socket: No such file or directory                          \r\n10:59:46.638 › processArgs: [                                                                                                                                                      \r\n  '/app/teams-for-linux/teams-for-linux',                                                                                                                                          \r\n  '--webDebug',                                                                                                                                                                    \r\n  '--logConfig={}'                                                                                                                                                                 \r\n]                                                                                                                                                                       \r\n10:59:46.639 › testing RegExp processArgs false                                                                                                                                    \r\n10:59:46.639 › testing RegExp processArgs false                                                                                                                                    \r\n10:59:46.639 › testing RegExp processArgs false                                                                                                                                    \r\n[2:1126/105946.640341:ERROR:bus.cc(407)] Failed to connect to the bus: Failed to connect to socket /run/dbus/system_bus_socket: No such file or directory                          \r\n[2:1126/105946.640415:ERROR:bus.cc(407)] Failed to connect to the bus: Failed to connect to socket /run/dbus/system_bus_socket: No such file or directory                          \r\n[2:1126/105946.640473:ERROR:bus.cc(407)] Failed to connect to the bus: Failed to connect to socket /run/dbus/system_bus_socket: No such file or directory                          \r\n10:59:46.640 › Waiting for network...                                                                                                                                              \r\n10:59:46.640 › Testing network using net.request() for https://teams.microsoft.com                                                                                                 \r\n10:59:46.642 › Spellchecker is disabled!                                                                                                                                           \r\n[52:1126/105947.039459:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.039728:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.039907:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.040060:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.040226:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.040381:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.040538:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.040656:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT                                                                  \r\n[52:1126/105947.040779:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.040955:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.041104:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.041260:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.041417:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.041581:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.041739:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[52:1126/105947.041854:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ                                                                 \r\n[52:1126/105947.041918:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.                                                                            \r\n[52:1126/105947.041994:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT                                                                  \r\n[52:1126/105947.042062:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ                                                                 \r\n[52:1126/105947.042130:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.                                                                            \r\n[52:1126/105947.042202:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT                                                                  \r\n[52:1126/105947.042267:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ                                                                 \r\n[52:1126/105947.042336:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.                                                                            \r\n[52:1126/105947.042482:ERROR:shared_image_manager.cc(248)] SharedImageManager::ProduceSkia: Trying to Produce a Skia representation from a non-existent mailbox.                   \r\n[52:1126/105947.042624:ERROR:gpu_service_impl.cc(1161)] Exiting GPU process because some drivers can't recover from errors. GPU process will restart shortly.                      \r\n[2:1126/105947.057929:ERROR:gpu_process_host.cc(982)] GPU process exited unexpectedly: exit_code=8704                                                                              \r\n[95:1126/105947.144520:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.144741:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.144934:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.145193:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.145373:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.145551:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.145807:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.145898:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT                                                                  \r\n[95:1126/105947.146067:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.146218:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.146372:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.146523:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.146695:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)                                                                        \r\n[95:1126/105947.146805:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[95:1126/105947.146920:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[95:1126/105947.147001:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ\r\n[95:1126/105947.147052:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.\r\n[95:1126/105947.147113:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT\r\n[95:1126/105947.147191:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ\r\n[95:1126/105947.147265:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.\r\n[95:1126/105947.147311:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT\r\n[95:1126/105947.147353:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ\r\n[95:1126/105947.147395:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.\r\n[95:1126/105947.147461:ERROR:shared_image_manager.cc(248)] SharedImageManager::ProduceSkia: Trying to Produce a Skia representation from a non-existent mailbox.\r\n[95:1126/105947.147553:ERROR:gpu_service_impl.cc(1161)] Exiting GPU process because some drivers can't recover from errors. GPU process will restart shortly.\r\n[2:1126/105947.164894:ERROR:gpu_process_host.cc(982)] GPU process exited unexpectedly: exit_code=8704\r\n10:59:47.168 › Network test successful with method https\r\n[108:1126/105947.307690:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.307955:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.308227:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.308470:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.308734:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.308943:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.309153:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.309278:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT\r\n[108:1126/105947.309445:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.309625:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.309826:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.310029:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.310233:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.310431:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.310580:ERROR:gbm_wrapper.cc(79)] Failed to get fd for plane.: No such file or directory (2)\r\n[108:1126/105947.310684:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ\r\n[108:1126/105947.310768:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.\r\n[108:1126/105947.310871:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT\r\n[108:1126/105947.310956:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ\r\n[108:1126/105947.311039:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.\r\n[108:1126/105947.311126:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=SCANOUT\r\n[108:1126/105947.311206:ERROR:gbm_pixmap_wayland.cc(82)] Cannot create bo with format= BGRA_8888 and usage=GPU_READ\r\n[108:1126/105947.311284:ERROR:shared_image_factory.cc(873)] CreateSharedImage: could not create backing.\r\n[108:1126/105947.311373:ERROR:shared_image_manager.cc(248)] SharedImageManager::ProduceSkia: Trying to Produce a Skia representation from a non-existent mailbox.\r\n[108:1126/105947.311477:ERROR:gpu_service_impl.cc(1161)] Exiting GPU process because some drivers can't recover from errors. GPU process will restart shortly.\r\n[2:1126/105947.327086:ERROR:gpu_process_host.cc(982)] GPU process exited unexpectedly: exit_code=8704\r\n10:59:47.949 › GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[2:1126/105947.955688:ERROR:object_proxy.cc(576)] Failed to call method: org.freedesktop.ScreenSaver.GetActive: object_path= /org/freedesktop/ScreenSaver: org.freedesktop.DBus.Error.NotSupported: This method is not implemented\r\n10:59:48.236 › did-frame-finish-load {} true\r\n10:59:48.236 › did-finish-load\r\n10:59:49.048 › cookie changed cause: overwrite \r\n removed?: true \r\n\r\n10:59:49.048 › cookie: authtoken \r\n expirationDate: 1732691120.742802 \r\n domain: teams.microsoft.com\r\n10:59:49.048 › cookie changed cause: explicit \r\n removed?: false \r\n\r\n10:59:49.048 › cookie: authtoken \r\n expirationDate: 1732691121.048007 \r\n domain: teams.microsoft.com\r\n10:59:49.258 › Badge count set to '0'\r\n10:59:49.268 › Badge count set to '0'\r\n10:59:50.273 › did-frame-finish-load {} false\r\n[131:1126/105950.497511:ERROR:gles2_cmd_decoder_passthrough.cc(1053)] [GroupMarkerNotSet(crbug.com/242999)!:A0E02C00FC2C0000]Automatic fallback to software WebGL has been deprecated. Please use the --enable-unsafe-swiftshader flag to opt in to lower security guarantees for trusted content.\r\n10:59:53.795 › window close\r\n[2:1126/105957.411551:ERROR:wayland_event_watcher.cc(47)] libwayland: wl_surface#26: error 0: gtk_shell::get_gtk_surface already requested\r\n\r\n\r\n",
    "state": "closed",
    "created_at": "2024-11-26T16:19:14+00:00",
    "updated_at": "2025-05-05T09:37:41+00:00",
    "closed_at": "2025-05-05T09:37:41+00:00",
    "user": "dwbotsch",
    "assignee": null,
    "labels": [
        "known issue/workaround",
        "flatpak",
        "Stale"
    ],
    "comments_count": 23,
    "html_url": "https://github.com/IsmaelMartinez/teams-for-linux/issues/1495",
    "is_pull_request": false
}