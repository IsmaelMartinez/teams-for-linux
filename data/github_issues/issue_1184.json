{
    "id": 2232439604,
    "number": 1184,
    "title": "Share Screen not working",
    "body": "**Describe the bug**\r\nI've installed teams-for-linux from snap on a clean freshly installed Ubuntu 22.04.4 LTS and I'm unable to share screen.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Start a meeting (with or without camera on)\r\n2. Click on the \"Share\" button and then on \"Screen, window or tab\"\r\n3. It then shows an error message \"Your video isn't working. We couldn't access your camera.\"\r\n\r\n**Expected behavior**\r\nList of displays/windows/tabs to share.\r\n\r\n**Screenshots**\r\n![image](https://github.com/IsmaelMartinez/teams-for-linux/assets/2507085/d8b89cb5-67c1-4567-bcb6-fda7cf1691b1)\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Ubuntu 22.04.4 LTS\r\n - Installation package: snap\r\n - Version: 1.4.18 rev 545 latest/stable \r\n\r\n**Debug**\r\nApplication running from the terminal using `--webDebug`:\r\nConsole logs:\r\n\r\n```bash\r\nteams-for-linux --webDebug --appLogLevels=error,info,warn,debug\r\n```\r\n\r\n```\r\n[DEBUG] configPath:,/home/user/snap/teams-for-linux/545/.config/teams-for-linux\r\n[WARN] No config file found, using default values\r\n[DEBUG] configFile:,[object Object]\r\n[INFO] Running under Wayland, switching to PipeWire...\r\ndbus-send: /snap/teams-for-linux/545/lib/x86_64-linux-gnu/libdbus-1.so.3: version `LIBDBUS_PRIVATE_1.12.20' not found (required by dbus-send)\r\n\r\n(teams-for-linux:63629): Gtk-WARNING **: 20:26:15.962: Theme parsing error: gtk.css:1413:23: 'font-feature-settings' is not a valid property name\r\n\r\n(teams-for-linux:63629): Gtk-WARNING **: 20:26:15.964: Theme parsing error: gtk.css:3286:25: 'font-feature-settings' is not a valid property name\r\n\r\n(teams-for-linux:63629): Gtk-WARNING **: 20:26:15.965: Theme parsing error: gtk.css:3748:23: 'font-feature-settings' is not a valid property name\r\n[DEBUG] Fetching custom background configuration from 'http://localhost/config.json'\r\nlibGL error: MESA-LOADER: failed to open iris (search paths /snap/teams-for-linux/545/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nlibGL error: failed to load driver: iris\r\nlibGL error: MESA-LOADER: failed to open swrast (search paths /snap/teams-for-linux/545/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nlibGL error: failed to load driver: swrast\r\n[63715:0408/202616.070955:ERROR:angle_platform_impl.cc(44)] Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[63715:0408/202616.071053:ERROR:gl_display.cc(515)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[63715:0408/202616.071077:ERROR:gl_display.cc(786)] eglInitialize OpenGL failed with error EGL_NOT_INITIALIZED, trying next display type\r\n[63715:0408/202616.071895:ERROR:angle_platform_impl.cc(44)] Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[63715:0408/202616.071928:ERROR:gl_display.cc(515)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[63715:0408/202616.071949:ERROR:gl_display.cc(786)] eglInitialize OpenGLES failed with error EGL_NOT_INITIALIZED\r\n[63715:0408/202616.071969:ERROR:gl_display.cc(820)] Initialization of all EGL display types failed.\r\n[63715:0408/202616.071991:ERROR:gl_ozone_egl.cc(26)] GLDisplayEGL::Initialize failed.\r\n[63715:0408/202616.073855:ERROR:angle_platform_impl.cc(44)] Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[63715:0408/202616.073891:ERROR:gl_display.cc(515)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[63715:0408/202616.073908:ERROR:gl_display.cc(786)] eglInitialize OpenGL failed with error EGL_NOT_INITIALIZED, trying next display type\r\n[63715:0408/202616.074536:ERROR:angle_platform_impl.cc(44)] Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[63715:0408/202616.074556:ERROR:gl_display.cc(515)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[63715:0408/202616.074573:ERROR:gl_display.cc(786)] eglInitialize OpenGLES failed with error EGL_NOT_INITIALIZED\r\n[63715:0408/202616.074588:ERROR:gl_display.cc(820)] Initialization of all EGL display types failed.\r\n[63715:0408/202616.074603:ERROR:gl_ozone_egl.cc(26)] GLDisplayEGL::Initialize failed.\r\n[63715:0408/202616.075244:ERROR:viz_main_impl.cc(196)] Exiting GPU process due to errors during initialization\r\n[DEBUG] Custom background service url is 'http://localhost'\r\n[DEBUG] processArgs:,/snap/teams-for-linux/545/teams-for-linux,--webDebug,--appLogLevels=error,info,warn,debug,--no-sandbox\r\n[DEBUG] Testing network using net.request() for https://teams.microsoft.com/\r\n[DEBUG] Spellchecker is disabled!\r\n\r\n(teams-for-linux:63629): Gtk-WARNING **: 20:26:16.092: Theme parsing error: gtk-dark.css:1413:23: 'font-feature-settings' is not a valid property name\r\n\r\n(teams-for-linux:63629): Gtk-WARNING **: 20:26:16.094: Theme parsing error: gtk-dark.css:3286:25: 'font-feature-settings' is not a valid property name\r\n\r\n(teams-for-linux:63629): Gtk-WARNING **: 20:26:16.094: Theme parsing error: gtk-dark.css:3748:23: 'font-feature-settings' is not a valid property name\r\n[ERROR] net::ERR_CONNECTION_REFUSED\r\n[63629:0408/202616.180860:ERROR:object_proxy.cc(576)] Failed to call method: org.freedesktop.login1.Manager.Inhibit: object_path= /org/freedesktop/login1: org.freedesktop.DBus.Error.AccessDenied: An AppArmor policy prevents this sender from sending this message to this recipient; type=\"method_call\", sender=\":1.216\" (uid=1000 pid=63629 comm=\"/snap/teams-for-linux/545/teams-for-linux --webDeb\" label=\"snap.teams-for-linux.teams-for-linux (enforce)\") interface=\"org.freedesktop.login1.Manager\" member=\"Inhibit\" error name=\"(unset)\" requested_reply=\"0\" destination=\"org.freedesktop.login1\" (uid=0 pid=1902 comm=\"/lib/systemd/systemd-logind \" label=\"unconfined\")\r\nlibGL error: MESA-LOADER: failed to open iris (search paths /snap/teams-for-linux/545/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nlibGL error: failed to load driver: iris\r\nlibGL error: MESA-LOADER: failed to open swrast (search paths /snap/teams-for-linux/545/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nlibGL error: failed to load driver: swrast\r\n[63753:0408/202616.232197:ERROR:angle_platform_impl.cc(44)] Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[63753:0408/202616.232314:ERROR:gl_display.cc(515)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[63753:0408/202616.232335:ERROR:gl_display.cc(786)] eglInitialize OpenGL failed with error EGL_NOT_INITIALIZED, trying next display type\r\n[63753:0408/202616.233113:ERROR:angle_platform_impl.cc(44)] Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[63753:0408/202616.233173:ERROR:gl_display.cc(515)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[63753:0408/202616.233190:ERROR:gl_display.cc(786)] eglInitialize OpenGLES failed with error EGL_NOT_INITIALIZED\r\n[63753:0408/202616.233207:ERROR:gl_display.cc(820)] Initialization of all EGL display types failed.\r\n[63753:0408/202616.233227:ERROR:gl_ozone_egl.cc(26)] GLDisplayEGL::Initialize failed.\r\n[63753:0408/202616.235179:ERROR:angle_platform_impl.cc(44)] Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[63753:0408/202616.235249:ERROR:gl_display.cc(515)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[63753:0408/202616.235267:ERROR:gl_display.cc(786)] eglInitialize OpenGL failed with error EGL_NOT_INITIALIZED, trying next display type\r\n[63753:0408/202616.235963:ERROR:angle_platform_impl.cc(44)] Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\nERR: Display.cpp:1052 (initialize): ANGLE Display::initialize error 12289: Could not create a backing OpenGL context.\r\n[63753:0408/202616.236016:ERROR:gl_display.cc(515)] EGL Driver message (Critical) eglInitialize: Could not create a backing OpenGL context.\r\n[63753:0408/202616.236033:ERROR:gl_display.cc(786)] eglInitialize OpenGLES failed with error EGL_NOT_INITIALIZED\r\n[63753:0408/202616.236050:ERROR:gl_display.cc(820)] Initialization of all EGL display types failed.\r\n[63753:0408/202616.236066:ERROR:gl_ozone_egl.cc(26)] GLDisplayEGL::Initialize failed.\r\n[63753:0408/202616.236889:ERROR:viz_main_impl.cc(196)] Exiting GPU process due to errors during initialization\r\nMESA-LOADER: failed to open iris (search paths /snap/teams-for-linux/545/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nfailed to load driver: iris\r\nMESA-LOADER: failed to open kms_swrast (search paths /snap/teams-for-linux/545/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nfailed to load driver: kms_swrast\r\nMESA-LOADER: failed to open swrast (search paths /snap/teams-for-linux/545/gnome-platform/usr/lib/x86_64-linux-gnu/dri)\r\nfailed to load swrast driver\r\n[63743:0408/202616.285244:ERROR:command_buffer_proxy_impl.cc(131)] ContextResult::kTransientFailure: Failed to send GpuControl.CreateCommandBuffer.\r\n[DEBUG] Network test successful with method https\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[63629:0408/202616.585295:ERROR:object_proxy.cc(576)] Failed to call method: org.freedesktop.ScreenSaver.GetActive: object_path= /org/freedesktop/ScreenSaver: org.freedesktop.DBus.Error.NotSupported: This method is not implemented\r\n[63629:0408/202616.690037:ERROR:CONSOLE(1)] \"Request Autofill.enable failed. {\"code\":-32601,\"message\":\"'Autofill.enable' wasn't found\"}\", source: devtools://devtools/bundled/core/protocol_client/protocol_client.js (1)\r\n[DEBUG] did-frame-finish-load,[object Object],true\r\n[DEBUG] did-finish-load\r\n[DEBUG] did-frame-finish-load,[object Object],true\r\n[DEBUG] did-finish-load\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] did-frame-finish-load,[object Object],true\r\n[DEBUG] did-finish-load\r\n[DEBUG] did-frame-finish-load,[object Object],false\r\n[63629:0408/202621.683816:ERROR:CONSOLE(1)] \"Request Autofill.enable failed. {\"code\":-32601,\"message\":\"'Autofill.enable' wasn't found\"}\", source: devtools://devtools/bundled/core/protocol_client/protocol_client.js (1)\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[63629:0408/202636.006357:ERROR:CONSOLE(1)] \"Request Target.setAutoAttach failed. {\"code\":-32601,\"message\":\"'Target.setAutoAttach' wasn't found\"}\", source: devtools://devtools/bundled/core/protocol_client/protocol_client.js (1)\r\n[63629:0408/202636.059945:ERROR:CONSOLE(1)] \"Request Target.setAutoAttach failed. {\"code\":-32601,\"message\":\"'Target.setAutoAttach' wasn't found\"}\", source: devtools://devtools/bundled/core/protocol_client/protocol_client.js (1)\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n[DEBUG] GetSystemIdleState => IdleTimeout: 300s, IdleTimeoutPollInterval: 10s, ActiveCheckPollInterval: 2s, IdleTime: 0s, IdleState: 'active'\r\n```\r\n\r\nLogs from the web browser debug:\r\n![image](https://github.com/IsmaelMartinez/teams-for-linux/assets/2507085/c0b47fde-6369-409b-a52d-3cf601c84d29)\r\n\r\n**Additional context**\r\nLet me know if any other testing is required.\r\n",
    "state": "closed",
    "created_at": "2024-04-09T01:29:16+00:00",
    "updated_at": "2024-08-13T10:14:12+00:00",
    "closed_at": "2024-05-15T06:16:51+00:00",
    "user": "floriangrousset",
    "assignee": null,
    "labels": [
        "snap",
        "known issue/workaround",
        "flatpak"
    ],
    "comments_count": 17,
    "html_url": "https://github.com/IsmaelMartinez/teams-for-linux/issues/1184",
    "is_pull_request": false
}